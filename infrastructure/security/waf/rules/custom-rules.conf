# Basic DDOS Protection Rules
SecRule &ARGS "@gt 255" \
    "id:1,\
    phase:2,\
    deny,\
    status:403,\
    msg:'Too many arguments in request',\
    severity:'CRITICAL'"

# Rate Limiting Rules
SecRule IP:REQUESTS "@gt 100" \
    "id:2,\
    phase:1,\
    deny,\
    status:429,\
    msg:'Rate limit exceeded',\
    severity:'WARNING'"

# SQL Injection Protection
SecRule ARGS "@detectSQLi" \
    "id:3,\
    phase:2,\
    deny,\
    status:403,\
    msg:'SQL Injection Attack Detected',\
    severity:'CRITICAL'"

# XSS Protection
SecRule ARGS "@detectXSS" \
    "id:4,\
    phase:2,\
    deny,\
    status:403,\
    msg:'XSS Attack Detected',\
    severity:'CRITICAL'"

# File Upload Protection
SecRule FILES_NAMES "@rx .*\.(?:php|phtml|php3|php4|php5|pl|py|jsp|asp|htm|shtml|sh|cgi)$" \
    "id:5,\
    phase:2,\
    deny,\
    status:403,\
    msg:'Malicious File Upload Attempted',\
    severity:'CRITICAL'"

# Request Size Limits
SecRequestBodyLimit 10485760
SecRequestBodyNoFilesLimit 1048576

# Brute Force Protection
SecRule IP:FAILED_LOGINS "@gt 5" \
    "id:6,\
    phase:1,\
    deny,\
    status:403,\
    msg:'Too many failed login attempts',\
    severity:'WARNING'"

# Path Traversal Protection
SecRule REQUEST_URI "@detectPathTraversal" \
    "id:7,\
    phase:1,\
    deny,\
    status:403,\
    msg:'Path Traversal Attack Detected',\
    severity:'CRITICAL'"

# Bad User Agents
SecRule REQUEST_HEADERS:User-Agent "@pmFromFile bad-user-agents.txt" \
    "id:8,\
    phase:1,\
    deny,\
    status:403,\
    msg:'Malicious User Agent Detected',\
    severity:'WARNING'"

# IP Reputation Check
SecRule REMOTE_ADDR "@ipMatchFromFile blacklisted-ips.txt" \
    "id:9,\
    phase:1,\
    deny,\
    status:403,\
    msg:'IP Address Blacklisted',\
    severity:'CRITICAL'"

# JSON/XML Body Processor
SecRule REQUEST_HEADERS:Content-Type "(?:application(?:/soap\+)?|text)/xml" \
    "id:10,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    setvar:reqbody_processor=XML"

SecRule REQUEST_HEADERS:Content-Type "application/json" \
    "id:11,\
    phase:1,\
    pass,\
    t:none,\
    nolog,\
    setvar:reqbody_processor=JSON" 